<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AIONEX — Your AI Assistant</title>
  <meta name="description" content="AIONEX — AI-powered assistant for wallpapers, math, learning, and more." />
  <link rel="icon" href="assets/logo.png">
  <style>
    :root {
      --bg:#0b0b0c;
      --panel:#111214;
      --accent:#00ffcc;
      --muted:#9aa0a6;
      --card:#141416;
      --radius:14px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--bg);
      color:#e6eef1;
      line-height:1.4;
      padding-bottom:120px;
    }
    header{
      position:sticky;
      top:0;
      background:var(--panel);
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:16px 28px;
      border-bottom:1px solid rgba(255,255,255,0.03);
    }
    .brand h1{color:var(--accent); margin:0; font-size:1.2rem;}
    nav a{color:var(--muted); text-decoration:none; margin-left:18px; font-size:0.95rem;}
    nav a:hover{color:var(--accent);}
    main{max-width:1200px;margin:28px auto;padding:0 18px;display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start;}
    .col-left{display:grid;gap:18px;}
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:0 8px 30px rgba(2,6,8,0.6);
      border:1px solid rgba(255,255,255,0.02);
    }
    .card h2{margin:0 0 10px 0;color:var(--accent);}
    .muted{color:var(--muted);}
    #chatArea{height:500px; display:flex; flex-direction:column;}
    .messages{flex:1;overflow:auto;padding:12px;display:flex;flex-direction:column;gap:10px;background:linear-gradient(180deg, rgba(0,0,0,0.02), transparent);border-radius:10px;}
    .msg{max-width:84%;padding:10px 12px;border-radius:12px;line-height:1.3;}
    .msg.assistant{background:rgba(0,255,204,0.05); color:#dffbf0;align-self:flex-start;}
    .msg.user{background:rgba(255,255,255,0.03); color:#fff;align-self:flex-end;}
    .controls{display:flex;gap:10px;margin-top:12px;}
    input[type="text"], textarea, select{width:100%;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);color:inherit;padding:10px;border-radius:10px;outline:none;font-size:0.95rem;}
    button{background:var(--accent);border:0;padding:10px 14px;border-radius:10px;color:#001;cursor:pointer;font-weight:600;}
    button.ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03);}
    .col-right{display:flex;flex-direction:column;gap:18px;position:sticky;top:78px;}
    .small-preview{height:120px;border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);background:#050506;display:flex;align-items:center;justify-content:center;color:var(--muted);}
    pre.output{white-space:pre-wrap;background:rgba(0,0,0,0.35);padding:12px;border-radius:8px;color:#e6f7f1;border:1px solid rgba(255,255,255,0.02);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;}
    footer{margin:42px 0 80px 0;text-align:center;color:var(--muted);font-size:0.9rem;}
    @media (max-width:980px){main{grid-template-columns:1fr; padding:18px}.col-right{position:relative;top:0;}}
  </style>
</head>
<body>
  <header>
    <div class="brand"><h1>AIONEX</h1></div>
    <nav>
      <a href="#chat">Chat</a>
      <a href="#wallpaper">Wallpapers</a>
      <a href="#math">Math</a>
      <a href="#learn">Lessons</a>
    </nav>
  </header>

  <main>
    <div class="col-left">
      <!-- Chat -->
      <section id="chat" class="card">
        <h2>AIONEX Chat</h2>
        <div class="muted">Ask anything — AI assistant for tech, math, wallpapers, or learning.</div>
        <div id="chatArea">
          <div class="messages" id="messages">
            <div class="msg assistant"><strong>AIONEX:</strong> Hello! Ask me anything.</div>
          </div>
          <form id="chatForm" class="controls" onsubmit="return false;">
            <input id="chatInput" type="text" placeholder="Ask AIONEX..." autocomplete="off" />
            <button id="sendBtn" type="button">Send</button>
          </form>
        </div>
      </section>

      <!-- Math solver -->
      <section id="math" class="card">
        <h2>Math Solver</h2>
        <div class="muted">Type a math problem to solve step-by-step.</div>
        <input id="mathInput" type="text" placeholder="e.g., solve 2x+3=11"/>
        <label><input type="checkbox" id="mathSteps" checked /> Show steps</label>
        <button id="mathSolveBtn">Solve</button>
        <pre id="mathResult" class="output"></pre>
      </section>

      <!-- Lessons -->
      <section id="learn" class="card">
        <h2>Lesson & Notes Generator</h2>
        <input id="lessonPrompt" placeholder="Type lesson topic or request..." />
        <button id="genLessonBtn">Generate Lesson</button>
        <pre id="lessonOutput" class="output"></pre>
      </section>
    </div>

    <aside class="col-right">
      <!-- Wallpaper -->
      <section id="wallpaper" class="card">
        <h2>Wallpaper Generator</h2>
        <input id="wallPrompt" type="text" placeholder="Wallpaper prompt..." />
        <select id="wallSize">
          <option value="1080x1920">Phone 1080×1920</option>
          <option value="1920x1080">Desktop 1920×1080</option>
        </select>
        <button id="genWallBtn">Generate</button>
        <div id="wallPreview" class="small-preview">No image yet</div>
      </section>
    </aside>
  </main>

  <footer>© <span id="year"></span> AIONEX — AI Assistant</footer>

  <script>
    const byId = id => document.getElementById(id);
    byId("year").textContent = new Date().getFullYear();

    function appendMsg(text, who="assistant"){
      const d = document.createElement("div");
      d.className = "msg " + (who==="user"?"user":"assistant");
      d.innerHTML = (who==="assistant"? "<strong>AIONEX:</strong> " : "") + text;
      byId("messages").appendChild(d);
      byId("messages").scrollTop = byId("messages").scrollHeight;
    }

    byId("sendBtn").addEventListener("click", async ()=>{
      const msg = byId("chatInput").value.trim();
      if(!msg) return;
      appendMsg(msg,"user");
      byId("chatInput").value="";
      appendMsg("Thinking...","assistant");

      try{
        const res = await fetch("/api/chat", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify({ message: msg })
        });
        const data = await res.json();
        const last = byId("messages").querySelector(".msg.assistant:last-child");
        if(last && last.textContent.includes("Thinking")) last.remove();
        appendMsg(data.reply ?? "Sorry, no reply.");
      }catch(err){
        const last = byId("messages").querySelector(".msg.assistant:last-child");
        if(last && last.textContent.includes("Thinking")) last.remove();
        appendMsg("Error: "+err.message);
      }
    });

    // Math solver
    byId("mathSolveBtn").addEventListener("click", async ()=>{
      const problem = byId("mathInput").value.trim();
      if(!problem) return;
      byId("mathResult").textContent="Solving...";
      try{
        const res = await fetch("/api/solve-math",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({problem,steps:byId("mathSteps").checked})});
        const data = await res.json();
        byId("mathResult").textContent = data.answer ?? "No result.";
      }catch(err){ byId("mathResult").textContent="Error: "+err.message; }
    });

    // Lesson generator
    byId("genLessonBtn").addEventListener("click", async ()=>{
      const prompt = byId("lessonPrompt").value.trim();
      if(!prompt) return;
      byId("lessonOutput").textContent="Generating...";
      try{
        const res = await fetch("/api/lesson",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt,type:"lesson"})});
        const data = await res.json();
        byId("lessonOutput").textContent = data.lessonText ?? "No lesson returned.";
      }catch(err){ byId("lessonOutput").textContent="Error: "+err.message; }
    });

    // Wallpaper generator
    byId("genWallBtn").addEventListener("click", async ()=>{
      const prompt = byId("wallPrompt").value.trim();
      const size = byId("wallSize").value;
      const preview = byId("wallPreview");
      if(!prompt) return;
      preview.textContent="Generating...";
      try{
        const res = await fetch("/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt,size})});
        const data = await res.json();
        const url = data.image_url ?? null;
        if(url) preview.innerHTML=`<img src="${url}" style="width:100%;height:100%;object-fit:cover" />`;
        else preview.textContent="Error generating image.";
      }catch(err){ preview.textContent="Error: "+err.message; }
    });
  </script>
</body>
</html>
